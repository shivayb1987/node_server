{"version":3,"sources":["../../src/security/passport.js"],"names":["LocalStrategy","Strategy","Security","use","usernameField","passwordField","passReqToCallback","req","username","password","done","debug","author","id","message","serializeUser","user","deserializeUser","name"],"mappings":";;;;;;;;AAAA;;;;AACA;;;;AACA;;;;;;;;AAEA,IAAMA,gBAAgB,wBAAGC,QAAzB;;IACqBC,Q;;;;;;;gCACA;AACjB,yBAASC,GAAT,CAAa,aAAb,EAA4B,IAAIH,aAAJ,CAAkB;AAC5CI,uBAAe,UAD6B;AAE5CC,uBAAe,UAF6B;AAG5CC,2BAAmB;AAHyB,OAAlB,EAIzB,UAACC,GAAD,EAAMC,QAAN,EAAgBC,QAAhB,EAA0BC,IAA1B,EAAmC;AACpC,yBAAOC,KAAP,CAAa,oCAAb,EAAmDH,QAAnD;AACA,YAAIA,aAAa,OAAb,IAAwBC,aAAa,UAAzC,EAAqD;AACnD,iBAAOC,KAAK,IAAL,EAAW;AAChBF,sBAAU,OADM;AAEhBI,oBAAQ,QAFQ;AAGhBC,gBAAI;AAHY,WAAX,CAAP;AAKD;AACD,eAAOH,KAAK,IAAL,EAAW,KAAX,EAAkB,EAAEI,SAAS,8BAAX,EAAlB,CAAP;AACD,OAd2B,CAA5B;AAeA,yBAASC,aAAT,CAAuB,UAACC,IAAD,EAAON,IAAP,EAAgB;AACrCA,aAAK,IAAL,EAAWM,KAAKH,EAAhB;AACD,OAFD;;AAIA,yBAASI,eAAT,CAAyB,UAACJ,EAAD,EAAKH,IAAL,EAAc;AACrCA,aAAK,IAAL,EAAW;AACTG,cAAI,CADK;AAETK,gBAAM;AAFG,SAAX;AAID,OALD;AAMD;;;;;;kBA3BkBhB,Q","file":"passport.js","sourcesContent":["import passport from 'passport';\r\nimport pl from 'passport-local';\r\nimport logger from '../logger';\r\n\r\nconst LocalStrategy = pl.Strategy;\r\nexport default class Security {\r\n  static configure() {\r\n    passport.use('local-login', new LocalStrategy({\r\n      usernameField: 'username',\r\n      passwordField: 'password',\r\n      passReqToCallback: true,\r\n    }, (req, username, password, done) => {\r\n      logger.debug('Inside local-login with username: ', username);\r\n      if (username === 'admin' && password === 'password') {\r\n        return done(null, {\r\n          username: 'admin',\r\n          author: 'auther',\r\n          id: 2,\r\n        });\r\n      }\r\n      return done(null, false, { message: 'Incorrect username/password.' });\r\n    }));\r\n    passport.serializeUser((user, done) => {\r\n      done(null, user.id);\r\n    });\r\n\r\n    passport.deserializeUser((id, done) => {\r\n      done(null, {\r\n        id: 2,\r\n        name: 'parmod',\r\n      });\r\n    });\r\n  }\r\n}\r\n"]}